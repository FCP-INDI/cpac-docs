# this is a C-PAC Docs content file 
meta:
  title: Custom Python dependencies in C-PAC containers
paragraphs:
  - paragraph: C-PAC is distributed as a <a href="../use#container">container image</a> with mutually compatible versions of its software dependencies. Sometimes you may need a different version of a small number of these dependencies than what C-PAC is built with.
  - paragraph: With the caveat that changing versions of some dependencies may cause unintented conflicts with other dependencies, this tutorial demonstrates how to use different versions of <code>pytorch</code> and <code>torchvision</code> than those included in the C-PAC image.
  - paragraph: This tutorial will use <a href="https://pypi.org/project/cpac">the cpac Python package</a> to interact with the C-PAC 1.8.7 image and conatiners. Adjust the commands as necessary to use Apptainer, Docker, or Singularity directly.
  - paragraph: "First, in a location that will be accessible to your containers when you run, create an empty directory to store the custom Python packages:"
  - codeblocks:
    - code: $ mkdir -p /home/example/path_to_custom_packages
      language: bash
  - paragraph: Next, shell into a container using the version of C-PAC you intend to run and binding that empty directory to <code>/home/c-pac_user/.local</code> in the container.
  - codeblocks:
    - code: $ cpac --tag release-v1.8.7 -B /home/example/path_to_custom_packages:/home/c-pac_user/.local enter
      language: bash
  - paragraph: Optionally, check that you're not <code>root</code> in the container.
  - codeblocks:
    - code: |
        $ whoami
        whoami: cannot find name for user ID 503
      language: bash
  - paragraph: You want the response to say anything except <code>root</code>.
  - paragraph: The <code>cpac</code> Python package tries to set your in-container user automatically, but if you're using container software directly, you may need additional flags to adjust your in-container user. If you run as <code>root</code>, C-PAC will probably still do what you want it to, but the custom Python packages will be owned as <code>root</code> in your local path (<code>/home/example/path_to_custom_packages</code>) which could be annoying to you or your system adminstrator.
  - paragraph: Next, check what dependencies are installed in this package by running
  - codeblocks:
    - code: $ python -c "from CPAC.utils.docs import version_report; print(version_report())"
      language: bash
  - subparagraphs:
    - paragraph: in the container.
  - codeblocks:
    - code: |
        AFNI: 23.3.09:linux_universal
        ldd: (Ubuntu GLIBC 2.35-0ubuntu3.1) 2.35
        Python: 3.10.6 | packaged by conda-forge | (main, Aug 22 2022, 20:36:39) [GCC 10.4.0]
          Python packages
          ---------------
          anyio: 3.7.1
          argon2-cffi: 21.3.0
          argon2-cffi-bindings: 21.2.0
          astor: 0.8.1
          asttokens: 2.2.1
          async-lru: 2.0.3
          attrs: 23.1.0
          awscli: 1.29.4
          Babel: 2.12.1
          backcall: 0.2.0
          backports.functools-lru-cache: 1.6.5
          beautifulsoup4: 4.12.2
          bids-validator: 1.14.0
          bleach: 6.0.0
          boto3: 1.28.4
          botocore: 1.31.4
          Brotli: 1.0.9
          brotlipy: 0.7.0
          cached-property: 1.5.2
          certifi: 2023.11.17
          cffi: 1.15.1
          charset-normalizer: 3.1.0
          ci-info: 0.3.0
          ciftify: 3.0.0+fcpindi
          click: 8.1.5
          click-aliases: 1.0.1
          colorama: 0.4.4
          comm: 0.1.3
          conda: 23.1.0
          conda-package-handling: 2.0.2
          conda_package_streaming: 0.8.0
          configparser: 5.3.0
          contourpy: 1.1.0
          CPAC: 1.8.7.dev1
          cryptography: 41.0.1
          cycler: 0.11.0
          Cython: 3.0.10
          debugpy: 1.6.7
          decorator: 5.1.1
          defusedxml: 0.7.1
          dill: 0.3.6
          docopt: 0.6.2
          docutils: 0.15.2
          entrypoints: 0.4
          etelemetry: 0.3.1
          exceptiongroup: 1.1.2
          executing: 1.2.0
          fastjsonschema: 2.17.1
          file-tree: 1.2.1
          file-tree-fsl: 0.2.1
          filelock: 3.13.1
          flit_core: 3.9.0
          flowdump: 0.1.2
          fonttools: 4.41.0
          formulaic: 0.5.2
          fsl-base: 2302.0
          fsl-get-standard: 0.1.0
          fsl-sub: 2.7.5
          fsl-sub-plugin-sge: 1.5.2
          fsl-sub-plugin-slurm: 1.4.4
          fsleyes: 1.6.1
          fsleyes-props: 1.10.0
          fsleyes-widgets: 0.14.3
          fslinstaller: 3.4.1
          fslpy: 3.11.3
          future: 0.18.3
          ghalton: 0.6.1
          h5py: 3.8.0
          hlsvdpropy: 2.0.1
          idna: 3.4
          imageio: 2.33.1
          importlib-metadata: 6.8.0
          importlib-resources: 6.0.0
          indexed-gzip: 1.7.1
          INDI-Tools: 0.0.7
          interface-meta: 1.3.0
          ipykernel: 6.24.0
          ipython: 8.14.0
          isodate: 0.6.1
          jedi: 0.18.2
          Jinja2: 3.1.2
          jmespath: 1.0.1
          joblib: 1.2.0
          json5: 0.9.14
          jsonschema: 4.18.4
          jsonschema-specifications: 2023.7.1
          jupyter-events: 0.6.3
          jupyter-lsp: 2.2.0
          jupyter_client: 8.3.0
          jupyter_core: 5.3.1
          jupyter_server: 2.7.0
          jupyter_server_terminals: 0.4.4
          jupyterlab: 4.0.3
          jupyterlab-pygments: 0.2.2
          jupyterlab_server: 2.23.0
          kiwisolver: 1.4.4
          lazy_loader: 0.3
          libmambapy: 1.4.2
          lockfile: 0.12.2
          looseversion: 1.3.0
          lxml: 4.9.2
          mamba: 1.4.2
          markdown-it-py: 3.0.0
          MarkupSafe: 2.1.3
          matplotlib: 3.7.1
          matplotlib-inline: 0.1.6
          mdurl: 0.1.0
          mistune: 3.0.0
          munkres: 1.1.4
          nbclient: 0.8.0
          nbconvert: 7.7.2
          nbformat: 5.9.1
          nest-asyncio: 1.5.6
          networkx: 3.1
          nibabel: 5.1.0
          nilearn: 0.10.0
          nipype: 1.8.6
          nitransforms: 23.0.1
          niworkflows: 1.10.0
          nose: 1.3.7
          notebook: 7.0.0
          notebook_shim: 0.2.3
          num2words: 0.5.13
          numpy: 1.25.1
          overrides: 7.3.1
          packaging: 23.1
          pandas: 2.0.3
          pandocfilters: 1.5.0
          parse: 1.19.1
          parso: 0.8.3
          pathlib2: 2.3.7.post1
          pathvalidate: 2.5.2
          patsy: 0.5.3
          pexpect: 4.8.0
          pickleshare: 0.7.5
          Pillow: 9.2.0
          pip: 23.1.2
          pkgutil_resolve_name: 1.3.10
          platformdirs: 3.9.1
          pluggy: 1.2.0
          pooch: 1.7.0
          progressbar2: 4.2.0
          prometheus-client: 0.17.1
          prompt-toolkit: 3.0.39
          prov: 2.0.0
          psutil: 5.9.5
          ptyprocess: 0.7.0
          pure-eval: 0.2.2
          pyasn1: 0.4.8
          PyBASC: 0.6.1
          pybids: 0.15.6
          pycosat: 0.6.4
          pycparser: 2.21
          pydicom: 2.4.1
          pydot: 2.0.0
          Pygments: 2.15.1
          pygraphviz: 1.12
          PyOpenGL: 3.1.6
          pyOpenSSL: 23.2.0
          pyparsing: 3.1.1
          PyPEER: 1.1
          PySocks: 1.7.1
          python-dateutil: 2.8.2
          python-json-logger: 2.0.7
          python-utils: 3.7.0
          pytz: 2023.3
          PyYAML: 6.0
          pyzmq: 25.1.0
          rdflib: 7.0.0
          referencing: 0.30.0
          requests: 2.31.0
          rfc3339-validator: 0.1.4
          rfc3986-validator: 0.1.1
          rich: 13.4.2
          rpds-py: 0.9.2
          rsa: 4.7.2
          Rtree: 1.0.1
          ruamel.yaml: 0.17.32
          ruamel.yaml.clib: 0.2.7
          s3transfer: 0.6.1
          scikit-image: 0.22.0
          scikit-learn: 1.2.2
          scipy: 1.11.1
          sdcflows: 2.4.0
          seaborn: 0.13.1
          semver: 3.0.1
          Send2Trash: 1.8.2
          setuptools: 68.0.0
          simplejson: 3.19.2
          six: 1.16.0
          sniffio: 1.3.0
          soupsieve: 2.3.2.post1
          SQLAlchemy: 1.3.24
          stack-data: 0.6.2
          svgutils: 0.3.4
          templateflow: 23.1.0
          terminado: 0.17.1
          threadpoolctl: 3.2.0
          tifffile: 2023.12.9
          tinycss2: 1.2.1
          tomli: 2.0.1
          toolz: 0.12.0
          tornado: 6.3.2
          tqdm: 4.65.0
          traitlets: 5.9.0
          traits: 6.3.2
          transforms3d: 0.4.1
          trimesh: 3.22.5
          typing-utils: 0.1.0
          typing_extensions: 4.7.1
          tzdata: 2023.3
          unicodedata2: 15.0.0
          urllib3: 1.26.15
          voluptuous: 0.13.1
          wcwidth: 0.2.6
          webencodings: 0.5.1
          websocket-client: 1.6.1
          wheel: 0.40.0
          wire: 1.0.0
          wrapt: 1.16.0
          wxnatpy: 0.4.0
          wxPython: 4.1.1
          xarray: 2023.7.0
          xnat: 0.5.1
          xvfbwrapper: 0.2.9
          zipp: 3.16.0
          zstandard: 0.19.0
  - paragraph: Because <code>PyTorch</code> is a fairly large package and, in the context of C-PAC, only used for UNet, its dependencies are not actually installed until the first time <code>torch</code> is loaded. In the container, we'll load torch from C-PAC to install the configured versions of those dependencies in our custom path.
  - codeblocks:
    - code: $ python -c "from CPAC.unet import torch"
      language: bash
  - paragraph: "We can re-run our version check and see what versions are installed:"
  - codeblocks:
    - code: $ python -c "from CPAC.utils.docs import version_report; print(version_report())"
      language: bash
    - code: |
        AFNI: 23.3.09:linux_universal
        ldd: (Ubuntu GLIBC 2.35-0ubuntu3.1) 2.35
        Python: 3.10.6 | packaged by conda-forge | (main, Aug 22 2022, 20:36:39) [GCC 10.4.0]
          Python packages
          ---------------
          anyio: 3.7.1
          argon2-cffi: 21.3.0
          argon2-cffi-bindings: 21.2.0
          astor: 0.8.1
          asttokens: 2.2.1
          async-lru: 2.0.3
          attrs: 23.1.0
          awscli: 1.29.4
          Babel: 2.12.1
          backcall: 0.2.0
          backports.functools-lru-cache: 1.6.5
          beautifulsoup4: 4.12.2
          bids-validator: 1.14.0
          bleach: 6.0.0
          boto3: 1.28.4
          botocore: 1.31.4
          Brotli: 1.0.9
          brotlipy: 0.7.0
          cached-property: 1.5.2
          certifi: 2023.11.17
          cffi: 1.15.1
          charset-normalizer: 3.1.0
          ci-info: 0.3.0
          ciftify: 3.0.0+fcpindi
          click: 8.1.5
          click-aliases: 1.0.1
          colorama: 0.4.4
          comm: 0.1.3
          conda: 23.1.0
          conda-package-handling: 2.0.2
          conda_package_streaming: 0.8.0
          configparser: 5.3.0
          contourpy: 1.1.0
          CPAC: 1.8.7.dev1
          cryptography: 41.0.1
          cycler: 0.11.0
          Cython: 3.0.10
          debugpy: 1.6.7
          decorator: 5.1.1
          defusedxml: 0.7.1
          dill: 0.3.6
          docopt: 0.6.2
          docutils: 0.15.2
          entrypoints: 0.4
          etelemetry: 0.3.1
          exceptiongroup: 1.1.2
          executing: 1.2.0
          fastjsonschema: 2.17.1
          file-tree: 1.2.1
          file-tree-fsl: 0.2.1
          filelock: 3.13.1
          flit_core: 3.9.0
          flowdump: 0.1.2
          fonttools: 4.41.0
          formulaic: 0.5.2
          fsl-base: 2302.0
          fsl-get-standard: 0.1.0
          fsl-sub: 2.7.5
          fsl-sub-plugin-sge: 1.5.2
          fsl-sub-plugin-slurm: 1.4.4
          fsleyes: 1.6.1
          fsleyes-props: 1.10.0
          fsleyes-widgets: 0.14.3
          fslinstaller: 3.4.1
          fslpy: 3.11.3
          future: 0.18.3
          ghalton: 0.6.1
          h5py: 3.8.0
          hlsvdpropy: 2.0.1
          idna: 3.4
          imageio: 2.33.1
          importlib-metadata: 6.8.0
          importlib-resources: 6.0.0
          indexed-gzip: 1.7.1
          INDI-Tools: 0.0.7
          interface-meta: 1.3.0
          ipykernel: 6.24.0
          ipython: 8.14.0
          isodate: 0.6.1
          jedi: 0.18.2
          Jinja2: 3.1.2
          jmespath: 1.0.1
          joblib: 1.2.0
          json5: 0.9.14
          jsonschema: 4.18.4
          jsonschema-specifications: 2023.7.1
          jupyter-events: 0.6.3
          jupyter-lsp: 2.2.0
          jupyter_client: 8.3.0
          jupyter_core: 5.3.1
          jupyter_server: 2.7.0
          jupyter_server_terminals: 0.4.4
          jupyterlab: 4.0.3
          jupyterlab-pygments: 0.2.2
          jupyterlab_server: 2.23.0
          kiwisolver: 1.4.4
          lazy_loader: 0.3
          libmambapy: 1.4.2
          lockfile: 0.12.2
          looseversion: 1.3.0
          lxml: 4.9.2
          mamba: 1.4.2
          markdown-it-py: 3.0.0
          MarkupSafe: 2.1.3
          matplotlib: 3.7.1
          matplotlib-inline: 0.1.6
          mdurl: 0.1.0
          mistune: 3.0.0
          munkres: 1.1.4
          nbclient: 0.8.0
          nbconvert: 7.7.2
          nbformat: 5.9.1
          nest-asyncio: 1.5.6
          networkx: 3.1
          nibabel: 5.1.0
          nilearn: 0.10.0
          nipype: 1.8.6
          nitransforms: 23.0.1
          niworkflows: 1.10.0
          nose: 1.3.7
          notebook: 7.0.0
          notebook_shim: 0.2.3
          num2words: 0.5.13
          numpy: 1.25.1
          nvidia-cublas-cu11: 11.10.3.66
          nvidia-cuda-nvrtc-cu11: 11.7.99
          nvidia-cuda-runtime-cu11: 11.7.99
          nvidia-cudnn-cu11: 8.5.0.96
          overrides: 7.3.1
          packaging: 23.1
          pandas: 2.0.3
          pandocfilters: 1.5.0
          parse: 1.19.1
          parso: 0.8.3
          pathlib2: 2.3.7.post1
          pathvalidate: 2.5.2
          patsy: 0.5.3
          pexpect: 4.8.0
          pickleshare: 0.7.5
          Pillow: 9.2.0
          pip: 23.1.2
          pkgutil_resolve_name: 1.3.10
          platformdirs: 3.9.1
          pluggy: 1.2.0
          pooch: 1.7.0
          progressbar2: 4.2.0
          prometheus-client: 0.17.1
          prompt-toolkit: 3.0.39
          prov: 2.0.0
          psutil: 5.9.5
          ptyprocess: 0.7.0
          pure-eval: 0.2.2
          pyasn1: 0.4.8
          PyBASC: 0.6.1
          pybids: 0.15.6
          pycosat: 0.6.4
          pycparser: 2.21
          pydicom: 2.4.1
          pydot: 2.0.0
          Pygments: 2.15.1
          pygraphviz: 1.12
          PyOpenGL: 3.1.6
          pyOpenSSL: 23.2.0
          pyparsing: 3.1.1
          PyPEER: 1.1
          PySocks: 1.7.1
          python-dateutil: 2.8.2
          python-json-logger: 2.0.7
          python-utils: 3.7.0
          pytz: 2023.3
          PyYAML: 6.0
          pyzmq: 25.1.0
          rdflib: 7.0.0
          referencing: 0.30.0
          requests: 2.31.0
          rfc3339-validator: 0.1.4
          rfc3986-validator: 0.1.1
          rich: 13.4.2
          rpds-py: 0.9.2
          rsa: 4.7.2
          Rtree: 1.0.1
          ruamel.yaml: 0.17.32
          ruamel.yaml.clib: 0.2.7
          s3transfer: 0.6.1
          scikit-image: 0.22.0
          scikit-learn: 1.2.2
          scipy: 1.11.1
          sdcflows: 2.4.0
          seaborn: 0.13.1
          semver: 3.0.1
          Send2Trash: 1.8.2
          setuptools: 68.0.0
          simplejson: 3.19.2
          six: 1.16.0
          sniffio: 1.3.0
          soupsieve: 2.3.2.post1
          SQLAlchemy: 1.3.24
          stack-data: 0.6.2
          svgutils: 0.3.4
          templateflow: 23.1.0
          terminado: 0.17.1
          threadpoolctl: 3.2.0
          tifffile: 2023.12.9
          tinycss2: 1.2.1
          tomli: 2.0.1
          toolz: 0.12.0
          torch: 1.13.1
          torchvision: 0.14.1
          tornado: 6.3.2
          tqdm: 4.65.0
          traitlets: 5.9.0
          traits: 6.3.2
          transforms3d: 0.4.1
          trimesh: 3.22.5
          typing-utils: 0.1.0
          typing_extensions: 4.7.1
          tzdata: 2023.3
          unicodedata2: 15.0.0
          urllib3: 1.26.15
          voluptuous: 0.13.1
          wcwidth: 0.2.6
          webencodings: 0.5.1
          websocket-client: 1.6.1
          wheel: 0.40.0
          wire: 1.0.0
          wrapt: 1.16.0
          wxnatpy: 0.4.0
          wxPython: 4.1.1
          xarray: 2023.7.0
          xnat: 0.5.1
          xvfbwrapper: 0.2.9
          zipp: 3.16.0
          zstandard: 0.19.0
  - paragraph: "We have <code>torch</code> v1.13.1 and <code>torchvision</code> v0.14.1. These are installed in <code>/home/c-pac_user/.local</code> in the container and therefore in <code>/home/example/path_to_custom_packages</code> locally."
  - paragraph: "Optionally, we can confirm that the software in <code>/home/example/path_to_custom_packages</code> is used in containers by leaving the current conainer and opening a new one with the same binding."
  - codeblocks:
    - code: |
        $ exit
        $ cpac --tag release-v1.8.7 -B /home/example/path_to_custom_packages:/home/c-pac_user/.local enter
        $ python -c "from CPAC.utils.docs import version_report; print(version_report())"
      language: bash
    - code: |
        AFNI: 23.3.09:linux_universal
        ldd: (Ubuntu GLIBC 2.35-0ubuntu3.1) 2.35
        Python: 3.10.6 | packaged by conda-forge | (main, Aug 22 2022, 20:36:39) [GCC 10.4.0]
          Python packages
          ---------------
          anyio: 3.7.1
          argon2-cffi: 21.3.0
          argon2-cffi-bindings: 21.2.0
          astor: 0.8.1
          asttokens: 2.2.1
          async-lru: 2.0.3
          attrs: 23.1.0
          awscli: 1.29.4
          Babel: 2.12.1
          backcall: 0.2.0
          backports.functools-lru-cache: 1.6.5
          beautifulsoup4: 4.12.2
          bids-validator: 1.14.0
          bleach: 6.0.0
          boto3: 1.28.4
          botocore: 1.31.4
          Brotli: 1.0.9
          brotlipy: 0.7.0
          cached-property: 1.5.2
          certifi: 2023.11.17
          cffi: 1.15.1
          charset-normalizer: 3.1.0
          ci-info: 0.3.0
          ciftify: 3.0.0+fcpindi
          click: 8.1.5
          click-aliases: 1.0.1
          colorama: 0.4.4
          comm: 0.1.3
          conda: 23.1.0
          conda-package-handling: 2.0.2
          conda_package_streaming: 0.8.0
          configparser: 5.3.0
          contourpy: 1.1.0
          CPAC: 1.8.7.dev1
          cryptography: 41.0.1
          cycler: 0.11.0
          Cython: 3.0.10
          debugpy: 1.6.7
          decorator: 5.1.1
          defusedxml: 0.7.1
          dill: 0.3.6
          docopt: 0.6.2
          docutils: 0.15.2
          entrypoints: 0.4
          etelemetry: 0.3.1
          exceptiongroup: 1.1.2
          executing: 1.2.0
          fastjsonschema: 2.17.1
          file-tree: 1.2.1
          file-tree-fsl: 0.2.1
          filelock: 3.13.1
          flit_core: 3.9.0
          flowdump: 0.1.2
          fonttools: 4.41.0
          formulaic: 0.5.2
          fsl-base: 2302.0
          fsl-get-standard: 0.1.0
          fsl-sub: 2.7.5
          fsl-sub-plugin-sge: 1.5.2
          fsl-sub-plugin-slurm: 1.4.4
          fsleyes: 1.6.1
          fsleyes-props: 1.10.0
          fsleyes-widgets: 0.14.3
          fslinstaller: 3.4.1
          fslpy: 3.11.3
          future: 0.18.3
          ghalton: 0.6.1
          h5py: 3.8.0
          hlsvdpropy: 2.0.1
          idna: 3.4
          imageio: 2.33.1
          importlib-metadata: 6.8.0
          importlib-resources: 6.0.0
          indexed-gzip: 1.7.1
          INDI-Tools: 0.0.7
          interface-meta: 1.3.0
          ipykernel: 6.24.0
          ipython: 8.14.0
          isodate: 0.6.1
          jedi: 0.18.2
          Jinja2: 3.1.2
          jmespath: 1.0.1
          joblib: 1.2.0
          json5: 0.9.14
          jsonschema: 4.18.4
          jsonschema-specifications: 2023.7.1
          jupyter-events: 0.6.3
          jupyter-lsp: 2.2.0
          jupyter_client: 8.3.0
          jupyter_core: 5.3.1
          jupyter_server: 2.7.0
          jupyter_server_terminals: 0.4.4
          jupyterlab: 4.0.3
          jupyterlab-pygments: 0.2.2
          jupyterlab_server: 2.23.0
          kiwisolver: 1.4.4
          lazy_loader: 0.3
          libmambapy: 1.4.2
          lockfile: 0.12.2
          looseversion: 1.3.0
          lxml: 4.9.2
          mamba: 1.4.2
          markdown-it-py: 3.0.0
          MarkupSafe: 2.1.3
          matplotlib: 3.7.1
          matplotlib-inline: 0.1.6
          mdurl: 0.1.0
          mistune: 3.0.0
          munkres: 1.1.4
          nbclient: 0.8.0
          nbconvert: 7.7.2
          nbformat: 5.9.1
          nest-asyncio: 1.5.6
          networkx: 3.1
          nibabel: 5.1.0
          nilearn: 0.10.0
          nipype: 1.8.6
          nitransforms: 23.0.1
          niworkflows: 1.10.0
          nose: 1.3.7
          notebook: 7.0.0
          notebook_shim: 0.2.3
          num2words: 0.5.13
          numpy: 1.25.1
          nvidia-cublas-cu11: 11.10.3.66
          nvidia-cuda-nvrtc-cu11: 11.7.99
          nvidia-cuda-runtime-cu11: 11.7.99
          nvidia-cudnn-cu11: 8.5.0.96
          overrides: 7.3.1
          packaging: 23.1
          pandas: 2.0.3
          pandocfilters: 1.5.0
          parse: 1.19.1
          parso: 0.8.3
          pathlib2: 2.3.7.post1
          pathvalidate: 2.5.2
          patsy: 0.5.3
          pexpect: 4.8.0
          pickleshare: 0.7.5
          Pillow: 9.2.0
          pip: 23.1.2
          pkgutil_resolve_name: 1.3.10
          platformdirs: 3.9.1
          pluggy: 1.2.0
          pooch: 1.7.0
          progressbar2: 4.2.0
          prometheus-client: 0.17.1
          prompt-toolkit: 3.0.39
          prov: 2.0.0
          psutil: 5.9.5
          ptyprocess: 0.7.0
          pure-eval: 0.2.2
          pyasn1: 0.4.8
          PyBASC: 0.6.1
          pybids: 0.15.6
          pycosat: 0.6.4
          pycparser: 2.21
          pydicom: 2.4.1
          pydot: 2.0.0
          Pygments: 2.15.1
          pygraphviz: 1.12
          PyOpenGL: 3.1.6
          pyOpenSSL: 23.2.0
          pyparsing: 3.1.1
          PyPEER: 1.1
          PySocks: 1.7.1
          python-dateutil: 2.8.2
          python-json-logger: 2.0.7
          python-utils: 3.7.0
          pytz: 2023.3
          PyYAML: 6.0
          pyzmq: 25.1.0
          rdflib: 7.0.0
          referencing: 0.30.0
          requests: 2.31.0
          rfc3339-validator: 0.1.4
          rfc3986-validator: 0.1.1
          rich: 13.4.2
          rpds-py: 0.9.2
          rsa: 4.7.2
          Rtree: 1.0.1
          ruamel.yaml: 0.17.32
          ruamel.yaml.clib: 0.2.7
          s3transfer: 0.6.1
          scikit-image: 0.22.0
          scikit-learn: 1.2.2
          scipy: 1.11.1
          sdcflows: 2.4.0
          seaborn: 0.13.1
          semver: 3.0.1
          Send2Trash: 1.8.2
          setuptools: 68.0.0
          simplejson: 3.19.2
          six: 1.16.0
          sniffio: 1.3.0
          soupsieve: 2.3.2.post1
          SQLAlchemy: 1.3.24
          stack-data: 0.6.2
          svgutils: 0.3.4
          templateflow: 23.1.0
          terminado: 0.17.1
          threadpoolctl: 3.2.0
          tifffile: 2023.12.9
          tinycss2: 1.2.1
          tomli: 2.0.1
          toolz: 0.12.0
          torch: 1.13.1
          torchvision: 0.14.1
          tornado: 6.3.2
          tqdm: 4.65.0
          traitlets: 5.9.0
          traits: 6.3.2
          transforms3d: 0.4.1
          trimesh: 3.22.5
          typing-utils: 0.1.0
          typing_extensions: 4.7.1
          tzdata: 2023.3
          unicodedata2: 15.0.0
          urllib3: 1.26.15
          voluptuous: 0.13.1
          wcwidth: 0.2.6
          webencodings: 0.5.1
          websocket-client: 1.6.1
          wheel: 0.40.0
          wire: 1.0.0
          wrapt: 1.16.0
          wxnatpy: 0.4.0
          wxPython: 4.1.1
          xarray: 2023.7.0
          xnat: 0.5.1
          xvfbwrapper: 0.2.9
          zipp: 3.16.0
          zstandard: 0.19.0
  - subparagraphs:
    - paragraph: We have <code>torch</code> and <code>torchvision</code> installed in our environment without having to import them first.
  - paragraph: "Let's say we want <code>torch</code> v2.9.0 and <code>torchvision</code> v0.24.0 instead of v1.13.1 and 0.14.1, respectively. In the container, we can simply run:"
  - codeblocks:
    - code: $ pip install --user torch==2.9.0 torchvision==0.24.0
      language: bash
    - code: …
      language: plain text
    - code: |
        Attempting uninstall: torch
          Found existing installation: torch 1.13.1
          Uninstalling torch-1.13.1:
            Successfully uninstalled torch-1.13.1
        Attempting uninstall: torchvision
          Found existing installation: torchvision 0.14.1
          Uninstalling torchvision-0.14.1:
            Successfully uninstalled torchvision-0.14.1
      language: Python
    - code: …
      language: plain text
  - paragraph: "Now we can exit the container, launch a new one with the same bindings and see our preferred version of the software is installed:"
  - codeblocks:
    - code: |
        $ exit
        $ cpac --tag release-v1.8.7 -B /home/example/path_to_custom_packages:/home/c-pac_user/.local enter
        $ python -c "from CPAC.utils.docs import version_report; print(version_report())"
      language: bash
    - code: |
        AFNI: 23.3.09:linux_universal
        ldd: (Ubuntu GLIBC 2.35-0ubuntu3.1) 2.35
        Python: 3.10.6 | packaged by conda-forge | (main, Aug 22 2022, 20:36:39) [GCC 10.4.0]
          Python packages
          ---------------
          anyio: 3.7.1
          argon2-cffi: 21.3.0
          argon2-cffi-bindings: 21.2.0
          astor: 0.8.1
          asttokens: 2.2.1
          async-lru: 2.0.3
          attrs: 23.1.0
          awscli: 1.29.4
          Babel: 2.12.1
          backcall: 0.2.0
          backports.functools-lru-cache: 1.6.5
          beautifulsoup4: 4.12.2
          bids-validator: 1.14.0
          bleach: 6.0.0
          boto3: 1.28.4
          botocore: 1.31.4
          Brotli: 1.0.9
          brotlipy: 0.7.0
          cached-property: 1.5.2
          certifi: 2023.11.17
          cffi: 1.15.1
          charset-normalizer: 3.1.0
          ci-info: 0.3.0
          ciftify: 3.0.0+fcpindi
          click: 8.1.5
          click-aliases: 1.0.1
          colorama: 0.4.4
          comm: 0.1.3
          conda: 23.1.0
          conda-package-handling: 2.0.2
          conda_package_streaming: 0.8.0
          configparser: 5.3.0
          contourpy: 1.1.0
          CPAC: 1.8.7.dev1
          cryptography: 41.0.1
          cycler: 0.11.0
          Cython: 3.0.10
          debugpy: 1.6.7
          decorator: 5.1.1
          defusedxml: 0.7.1
          dill: 0.3.6
          docopt: 0.6.2
          docutils: 0.15.2
          entrypoints: 0.4
          etelemetry: 0.3.1
          exceptiongroup: 1.1.2
          executing: 1.2.0
          fastjsonschema: 2.17.1
          file-tree: 1.2.1
          file-tree-fsl: 0.2.1
          filelock: 3.13.1
          flit_core: 3.9.0
          flowdump: 0.1.2
          fonttools: 4.41.0
          formulaic: 0.5.2
          fsl-base: 2302.0
          fsl-get-standard: 0.1.0
          fsl-sub: 2.7.5
          fsl-sub-plugin-sge: 1.5.2
          fsl-sub-plugin-slurm: 1.4.4
          fsleyes: 1.6.1
          fsleyes-props: 1.10.0
          fsleyes-widgets: 0.14.3
          fslinstaller: 3.4.1
          fslpy: 3.11.3
          fsspec: 2025.9.0
          future: 0.18.3
          ghalton: 0.6.1
          h5py: 3.8.0
          hlsvdpropy: 2.0.1
          idna: 3.4
          imageio: 2.33.1
          importlib-metadata: 6.8.0
          importlib-resources: 6.0.0
          indexed-gzip: 1.7.1
          INDI-Tools: 0.0.7
          interface-meta: 1.3.0
          ipykernel: 6.24.0
          ipython: 8.14.0
          isodate: 0.6.1
          jedi: 0.18.2
          Jinja2: 3.1.2
          jmespath: 1.0.1
          joblib: 1.2.0
          json5: 0.9.14
          jsonschema: 4.18.4
          jsonschema-specifications: 2023.7.1
          jupyter-events: 0.6.3
          jupyter-lsp: 2.2.0
          jupyter_client: 8.3.0
          jupyter_core: 5.3.1
          jupyter_server: 2.7.0
          jupyter_server_terminals: 0.4.4
          jupyterlab: 4.0.3
          jupyterlab-pygments: 0.2.2
          jupyterlab_server: 2.23.0
          kiwisolver: 1.4.4
          lazy_loader: 0.3
          libmambapy: 1.4.2
          lockfile: 0.12.2
          looseversion: 1.3.0
          lxml: 4.9.2
          mamba: 1.4.2
          markdown-it-py: 3.0.0
          MarkupSafe: 2.1.3
          matplotlib: 3.7.1
          matplotlib-inline: 0.1.6
          mdurl: 0.1.0
          mistune: 3.0.0
          mpmath: 1.3.0
          munkres: 1.1.4
          nbclient: 0.8.0
          nbconvert: 7.7.2
          nbformat: 5.9.1
          nest-asyncio: 1.5.6
          networkx: 3.1
          nibabel: 5.1.0
          nilearn: 0.10.0
          nipype: 1.8.6
          nitransforms: 23.0.1
          niworkflows: 1.10.0
          nose: 1.3.7
          notebook: 7.0.0
          notebook_shim: 0.2.3
          num2words: 0.5.13
          numpy: 1.25.1
          nvidia-cublas-cu11: 11.10.3.66
          nvidia-cublas-cu12: 12.8.4.1
          nvidia-cuda-cupti-cu12: 12.8.90
          nvidia-cuda-nvrtc-cu11: 11.7.99
          nvidia-cuda-nvrtc-cu12: 12.8.93
          nvidia-cuda-runtime-cu11: 11.7.99
          nvidia-cuda-runtime-cu12: 12.8.90
          nvidia-cudnn-cu11: 8.5.0.96
          nvidia-cudnn-cu12: 9.10.2.21
          nvidia-cufft-cu12: 11.3.3.83
          nvidia-cufile-cu12: 1.13.1.3
          nvidia-curand-cu12: 10.3.9.90
          nvidia-cusolver-cu12: 11.7.3.90
          nvidia-cusparse-cu12: 12.5.8.93
          nvidia-cusparselt-cu12: 0.7.1
          nvidia-nccl-cu12: 2.27.5
          nvidia-nvjitlink-cu12: 12.8.93
          nvidia-nvshmem-cu12: 3.3.20
          nvidia-nvtx-cu12: 12.8.90
          overrides: 7.3.1
          packaging: 23.1
          pandas: 2.0.3
          pandocfilters: 1.5.0
          parse: 1.19.1
          parso: 0.8.3
          pathlib2: 2.3.7.post1
          pathvalidate: 2.5.2
          patsy: 0.5.3
          pexpect: 4.8.0
          pickleshare: 0.7.5
          Pillow: 9.2.0
          pip: 23.1.2
          pkgutil_resolve_name: 1.3.10
          platformdirs: 3.9.1
          pluggy: 1.2.0
          pooch: 1.7.0
          progressbar2: 4.2.0
          prometheus-client: 0.17.1
          prompt-toolkit: 3.0.39
          prov: 2.0.0
          psutil: 5.9.5
          ptyprocess: 0.7.0
          pure-eval: 0.2.2
          pyasn1: 0.4.8
          PyBASC: 0.6.1
          pybids: 0.15.6
          pycosat: 0.6.4
          pycparser: 2.21
          pydicom: 2.4.1
          pydot: 2.0.0
          Pygments: 2.15.1
          pygraphviz: 1.12
          PyOpenGL: 3.1.6
          pyOpenSSL: 23.2.0
          pyparsing: 3.1.1
          PyPEER: 1.1
          PySocks: 1.7.1
          python-dateutil: 2.8.2
          python-json-logger: 2.0.7
          python-utils: 3.7.0
          pytz: 2023.3
          PyYAML: 6.0
          pyzmq: 25.1.0
          rdflib: 7.0.0
          referencing: 0.30.0
          requests: 2.31.0
          rfc3339-validator: 0.1.4
          rfc3986-validator: 0.1.1
          rich: 13.4.2
          rpds-py: 0.9.2
          rsa: 4.7.2
          Rtree: 1.0.1
          ruamel.yaml: 0.17.32
          ruamel.yaml.clib: 0.2.7
          s3transfer: 0.6.1
          scikit-image: 0.22.0
          scikit-learn: 1.2.2
          scipy: 1.11.1
          sdcflows: 2.4.0
          seaborn: 0.13.1
          semver: 3.0.1
          Send2Trash: 1.8.2
          setuptools: 68.0.0
          simplejson: 3.19.2
          six: 1.16.0
          sniffio: 1.3.0
          soupsieve: 2.3.2.post1
          SQLAlchemy: 1.3.24
          stack-data: 0.6.2
          svgutils: 0.3.4
          sympy: 1.14.0
          templateflow: 23.1.0
          terminado: 0.17.1
          threadpoolctl: 3.2.0
          tifffile: 2023.12.9
          tinycss2: 1.2.1
          tomli: 2.0.1
          toolz: 0.12.0
          torch: 2.9.0
          torchvision: 0.24.0
          tornado: 6.3.2
          tqdm: 4.65.0
          traitlets: 5.9.0
          traits: 6.3.2
          transforms3d: 0.4.1
          trimesh: 3.22.5
          triton: 3.5.0
          typing-utils: 0.1.0
          typing_extensions: 4.7.1
          tzdata: 2023.3
          unicodedata2: 15.0.0
          urllib3: 1.26.15
          voluptuous: 0.13.1
          wcwidth: 0.2.6
          webencodings: 0.5.1
          websocket-client: 1.6.1
          wheel: 0.40.0
          wire: 1.0.0
          wrapt: 1.16.0
          wxnatpy: 0.4.0
          wxPython: 4.1.1
          xarray: 2023.7.0
          xnat: 0.5.1
          xvfbwrapper: 0.2.9
          zipp: 3.16.0
          zstandard: 0.19.0
  - paragraph: If you want to specify versions for other Python packages, follow the same steps for those dependencies.
  - paragraph: "⚠️ Note:"
    subparagraphs:
      - paragraph: "⚠️ Only Python dependencies will be found in <code>/home/c-pac_user/.local</code> in the container, so only Python dependencies can be customized this way."
      - paragraph: "⚠️ Only <code>torch</code> and <code>torchvision</code> are installed just-in-time, so only those packages need the"
      - codeblocks:
        - code: from CPAC.unet import torch
          language: Python
      - subparagraphs:
        - paragraph: step. In fact, that step is only necessary for those requirements if you care to check the predefined versions. If you want to install specific versions of these dependencies without checking the packaged versions, you can skip that step.
  - paragraph: Just make sure you bind your local custom installation path to <code>/home/c-pac_user/.local</code> in each C-PAC container you want to use these versions of these dependencies in.